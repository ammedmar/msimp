% !TEX root = ../msimplicial.tex

\section{\pdfEinfty-structures} \label{s:operads and props}

The goal of this section is to define an explicit $E_\infty$-algebra structure on multisimplicial cochains.
That is to say, a product descending to the ring structure on cohomology together with a coherent family of homotopies correcting its lack of commutativity at the cochain level.

We begin by reviewing basic material concerning the theory of operads and props, referring the reader to, for example, \cite{markl2008props} for a more complete treatment.
We then recall the definition of the finitely presented prop $\M$ introduced in \cite{medina2020prop1} and whose associated operad is a model for the $E_\infty$-operad.
Given its small number of generators and relations, $\M$ is well suited to define $E_\infty$-structures.
We recall from the same source one such structure on simplicial cochains, which we monoidally extend to achieve our stated goal.

\subsection{Symmetric modules and bimodules}

Let $\S$ be the category whose objects are the natural numbers and whose set of morphisms between $m$ and $n$ is empty if $m \neq n$ and is otherwise the symmetric group $\S_n$.
A \textit{left $\S$-module} (resp. \textit{right} $\S$-\textit{module} or $\S$-\textit{bimodule}) is a functor from $\S$ (resp. $\S^\op$ or $\S \times \S^\op$) to $\Ch$.
In this paper we prioritize left module structures over their right counterparts.
As usual, taking inverses makes both perspectives equivalent.
We respectively denote by $\Smod$ and $\Sbimod$ the categories of left $\S$-modules and of $\S$-bimodules with morphisms given by natural transformations.

The group homomorphisms $\S_n \to \S_n \times \S_1$ induce a forgetful functor
\[
\forget \colon \Sbimod \to \Smod,
\]
given explicitly by $\forget(\cP)(r) = \cP(1, r)$ for $r \in \N$.
The similarly defined forgetful functor to right $\S$-modules will not be used.

\subsection{Composition structures}

We can define \textit{operads} and \textit{props} by enriching $\S$-modules and $\S$-bimodules with certain composition structures.
For a complete presentation of these concepts we refer to Definition~11 and 54 of \cite{markl2008props}.
Intuitively, using examples defined in the next subsection, operads and props can be understood by abstracting the composition structure naturally present in the left $\S$-module $\End^C$ (or right $\S$-module $\End_C$), naturally an operad, and the $\S$-bimodule $\End^C_C$, naturally a prop.
We remark that the prop structure on $\cP$ restricts to an operad structure on $\forget(\cP)$.

\subsection{Representations}

Given a chain complex $C$ define
\begin{gather*}
\End^C(r) = \Hom(C, C^{\ot r}), \qquad
\End_C(r) = \Hom(C^{\ot r}, C), \\
\End^C_C(r, s) = \Hom(C^{\ot r}, C^{\ot s}),
\end{gather*}
with their natural operad and prop structures respectively.
We remark that the forgetful functor $\forget$ sends $\End^C_C$ to $\End^C$.

Let $C$ be a chain complex, $\cO$ an operad, and $\cP$ a prop.
An $\cO$-\textit{coalgebra} (resp. $\cO$-\textit{algebra} or $\cP$-\textit{bialgebra}) structure on $C$ is a structure preserving morphism $\cO \to \End^C$ (resp. $\cO \to \End_C$ or $\cP \to \End_C^C$).

\subsection{\pdfEinfty-operads}

Recall that a \textit{free $\S_r$-resolution} of a chain complex $C$ is a quasi-isomorphism $R \to C$ from a chain complex of free $\k[\S_r]$-modules.

An $\S$-module $M$ is said to be $E_{\infty}$ if there exists a morphism of $\S$-modules $M \to \underline{\k}$ inducing for each $r \in \N$ a free $\S_r$-resolution $M(r) \to \k$.

An operad is said to be $E_{\infty}$ if its underlying $\S$-module is $E_\infty$.

\subsection{Free prop construction} \label{ss:free prop}

\begin{figure}
	\input{aux/immersion}
	\caption{Immersed graphs represent labeled directed graphs with the direction implicitly given from top to bottom and the labeling from left to right.}
	\label{f:immersion}
\end{figure}

The \textit{free prop} $\free(M)$ generated by an $\S$-bimodule $M$ is constructed using isomorphism classes of directed graphs with no directed loops that are enriched with the following labeling structure.
We think of each directed edge as built from two compatibly directed half-edges.
For each vertex $v$ of a directed graph $\Gamma$, we have the sets $in(v)$ and $out(v)$ of half-edges that are respectively incoming to and outgoing from $v$.
Half-edges that do not belong to $in(v)$ or $out(v)$ for any $v$ are divided into the disjoint sets $in(\Gamma)$ and $out(\Gamma)$ of incoming and outgoing external half-edges.
For any positive integer $n$ let $\overline{n} = \{1, \dots, n\}$ and set $\overline{0} = \emptyset$.
For any finite set $S$, denote the cardinality of $S$ by $|S|$.
The labeling is given by bijections
\[
\overline{|in(\Gamma)|}\to in(\Gamma), \qquad
\overline{|out(\Gamma)|}\to out(\Gamma),
\]
and
\[
\overline{|in(v)|}\to in(v), \qquad
\overline{|out(v)|}\to out(v),
\]
for every vertex $v$.
We refer to the isomorphism classes of such labeled directed graphs with no directed loops as $(n,m)$\textit{-graphs} denoting the set of these by $\graphs(m,n)$.
We use graphs immersed in the plane to represent elements in $\graphs(m,n)$, please see \cref{f:immersion}.
We consider the right action of $\S_n$ and the left action of $\S_m$ on a $(n,m)$-graph given respectively by permuting the labels of $in(\Gamma)$ and $out(\Gamma)$.
This action defines the $\S$-bimodule structure on the free prop
\begin{equation} \label{e:free prop}
\free(M)(m,n) \ = \bigoplus_{\Gamma \in \graphs(m,n)} \bigotimes_{v \in Vert(\Gamma)} out(v) \ot_{\S_q} M(p, q) \ot_{\S_p} in(v),
\end{equation}
where we simplified the notation writing $p$ and $q$ for $\overline{|in(v)|}$ and $\overline{|out(v)|}$ respectively.
The composition structure is defined by (relabeled) grafting and disjoint union.

\subsection{The prop $\M$}

We now recall the model of $E_\infty$ that is central to our constructions.

\begin{definition}
	Let $\M$ be the prop generated by
	\begin{equation} \label{e:generators of M}
	\counit\,, \hspace*{.6cm} \coproduct\,, \hspace*{.6cm} \product,
	\end{equation}
	in degrees $0$, $0$ and $1$ respectively, and boundaries
	\begin{equation} \label{e:boundary of M}
	\partial\ \counit = 0,
	\hspace*{.6cm}
	\partial\, \coproduct = 0,
	\hspace*{.6cm}
	\partial \product = \ \boundary\,,
	\end{equation}
	modulo the prop ideal generated by
	\begin{equation} \label{e:relations of M}
	\leftcounitality\,, \hspace*{.6cm} \rightcounitality\,, \hspace*{.6cm} \productcounit.
	\end{equation}
\end{definition}

Explicitly, any element in $\M(m,n)$ can be written as a linear combination of the $(m,n)$-graphs generated by those in \eqref{e:generators of M} via grafting, disjoint union and relabeling, modulo the prop ideal generated by the relations in \eqref{e:relations of M}. Its boundary is determined, using \eqref{e:free prop}, by \eqref{e:boundary of M}.

As proven in \cite[Theorem 3.3]{medina2020prop1} we have the following.

\begin{proposition}
	The operad $\UM$ is $E_{\infty}$.
\end{proposition}

We remark that, as proven in \cite{medina2018prop2}, this prop is obtained from applying the functor of cellular chains to a finitely presented prop over the category of CW-complexes.

\subsection{Hopf operads and props}

So far we have consider operad and props over the category $\Ch$ but, since $\coAlg$ is also a symmetric monoidal category, we can consider them over $\coAlg$.
That is to say, demand that all defining chain complexes be coalgebras and all compositions be morphisms of these.
We refer to operads and props over $\coAlg$ as \textit{Hopf operads} and \textit{props} respectively.

If $\cO$ is a Hopf operad, the category $\coAlg_\cO$ is monoidal.
The structure maps of a product of $\cO$-coalgebras $C \ot C^\prime$ are given by
\[
\begin{tikzcd} [column sep = normal, row sep=normal]
\cO(r) \ot (C \ot C^\prime) \arrow[r, "\Delta_\cO \ot \id"] &[10 pt]
\cO(r) \ot \cO(r) \ot (C \ot C^\prime) \arrow[d, "Sh"'] & \\ &
\big(\cO(r) \ot C \big) \ot \big( \cO(r) \ot C \big) \arrow[r] &
C^{\ot r} \ot C^{\prime\, \ot r} \arrow[d, "Sh"] & \\ & &
(C \ot C^\prime)^{\ot r}.
\end{tikzcd}
\]
Similarly, if $\cP$ is a Hopf prop then its category of representations is also monoidal.

\subsection{Hopf structure on $\M$} \label{ss:hopf prop M}

As proven in \cite{medina2021cobar}, the prop $\M$ is Hopf with coproduct $\Delta_\M$ and counit $\varepsilon_\M$ induced by
\begin{align*}
\coproduct & \mapsto \coproduct \ot \coproduct \,, &
\coproduct & \mapsto 1, \\
\counit \ & \mapsto \ \counit \ \ot \ \counit \,, &
\counit \ & \mapsto 1, \\
\product & \mapsto \rightboundary \ \ot \product + \product \ot \ \leftboundary \,, &
\coproduct & \mapsto 0.
\end{align*}
It follows from the previous subsection that $\coAlg_\UM$ is a monoidal category.

\subsection{Simplicial $E_{\infty}$-structure} \label{ss:e-infty on simplicial}

We review from \cite{medina2020prop1} a natural $\mathcal M$-structure on the chains of standard simplices.
These define, for any simplicial set, a natural $\UM$-structure on its chains generalizing the $E_{\infty}$-coalgebra structures constructed by McClure--Smith \cite{mcclure2003multivariable} and Berger--Fresse \cite{berger2004combinatorial}.

An $\M$-structure is specified by three linear maps, the images of the generators
\[
\counit, \quad \coproduct, \quad \product,
\]
satisfying the relations in the presentation of $\mathcal M$.
For the chains on standard simplices, the first two generators are send respectively to the counit and coproduct of the Alexander--Whitney coalgebra, and the third generator to an algebraic version of the join $\ast \colon \chains(\simplex^n)^{\ot 2} \to \chains(\simplex^n)$ defined by
\[
\left[v_0, \dots, v_p \right] \ast \left[v_{p+1}, \dots, v_q\right] = \begin{cases} (-1)^{p+|\pi|} \left[ v_{\pi(0)}, \dots, v_{\pi(q)} \right] & \text{ if } v_i \neq v_j \text{ for } i \neq j, \\
0 & \text{ otherwise}, \end{cases}
\]
where $\pi$ is the permutation that orders the set of vertices, and $(-1)^{|\pi|}$ is its sign.

From \cite{medina2020prop1} we have the following result.

\begin{proposition} \label{p:simplicial chain bialgebra}
	For every $n \in \mathbb{N}$, the assignment
	\[
	\counit \mapsto \epsilon, \quad \coproduct \mapsto \Delta, \quad \product \mapsto \ast,
	\]
	defines a natural $\mathcal M$-structure on $\chains(\simplex^n)$.
\end{proposition}

The chains on general simplicial sets are not equipped with an $\M$-structure, but using the forgetful functor from $\biAlg_{\M}$ to the cocomplete category $\coAlg_\UM$ allows us to Yoneda extend the induced natural $\UM$-structures on standard simplices to all simplicial sets.
Specifically, we obtain an extension of the Alexander--Whitney coalgebra in the form of a lift:
\[
\begin{tikzcd}[column sep=normal, row sep=small]
& \coAlg_\UM \arrow[d] \\
\sSet \arrow[r, "\schains"]
\arrow[ur, "\schainsUM", out=60, in=180, near start, dashed]
& \Ch.
\end{tikzcd}
\]

A similar argument using the duality functor provides simplicial cochains with a $\UM$-algebra structure.

\subsection{Multisimplicial \pdfEinfty-structure}

We use the monoidal structure on $\coAlg_\UM$ to define a lift of the functor of multisimplicial chains to the category of $\UM$-coalgebras
\[
\mchainskUM \defeq \Big(\schainsUM\Big)^{\ot k}
\]
fitting in the following commutative diagram:
\[
\begin{tikzcd}[column sep=normal, row sep=small]
& \coAlg_\UM \arrow[d] \\
\arrow[ur, "\mchainskUM", out=60, in=180, near start, dashed]
\sSet^k \arrow[r, "\mchainsk"]
& \Ch.
\end{tikzcd}
\]

As before, a similar construction provides multisimplicial cochains with a $\UM$-algebra structure.

\subsection{Explicit description}

We now introduce linear maps on the chains of representable multisimplicial sets defining a natural $\M$-structure on each of them.
These forget to natural $\UM$-structures defining, via Yoneda extension, the functor $\mchainskUM$ from the previous subsection.
The case $k = 1$ reduces to the $\M$-structure on simplicial chains, which we monoidally extend for $k > 1$.

Let $C$ denote $\mchainsk(\simplex^{n_1} \times \dots \times \simplex^{n_k})$ and consider basis elements $x = x_1 \ot \dots \ot x_k$ and $y = y_1 \ot \dots \ot y_k$ in $C$.

The \textit{multisimplicial counit} $\varepsilon \colon C \to \k$ is defined by
\[
\varepsilon(x) = \varepsilon(x_1) \dotsm \varepsilon(x_k).
\]

The \textit{multisimplicial coproduct} $\Delta \colon C \to C \ot C$ is defined by
\[
\Delta (x_1 \ot \dots \ot x_n) =
\sum \pm \left( x_1^{(1)} \ot \dots \ot x_n^{(1)} \right) \ot
\left( x_1^{(2)} \ot \dots \ot x_n^{(2)} \right),
\]
where the sign is determined using the Koszul convention, and we are using Sweedler's notation
\[
\Delta(x_i) = \sum x_i^{(1)} \ot x_i^{(2)}
\]
for the coproduct $\Delta \colon \chains(\simplex^{n_i}) \to \chains(\simplex^{n_i})^{\ot 2}$.

The \textit{multisimplicial join} $\ast \colon C \ot C \to C$ is defined by
\begin{align*}
(x_1 \ot \dots \ot x_n) \ast (y_1 \ot \dots \ot y_n) =
(-1)^{|x|} \sum_{i=1}^n x_{<i}\, \epsilon(y_{<i}) \ot x_i \ast y_i \ot \epsilon(x_{>i}) \, y_{>i},
\end{align*}
where
\begin{align*}
x_{<i} & = x_1 \ot \dots \ot x_{i-1}, &
y_{<i} & = y_1 \ot \dots \ot y_{i-1}, \\
x_{>i} & = x_{i+1} \ot \dots \ot x_n, &
y_{>i} & = y_{i+1} \ot \dots \ot y_n,
\end{align*}
with the convention
\[
x_{<1} = y_{<1} = x_{>n} = y_{>n} = 1 \in \Z,
\]
and $x_i \ast y_i$ is the join in $\chains(\simplex^{n_i})$.

\subsection{Steenrod operations}

Throughout this subsection let us consider $\k$ to be the finite field $\Fp$ and $X$ a multisimplicial set.

Since the complex of cochains on $X$ is an $E_\infty$-algebra, the mod $p$ cohomology $H_\bullet^{\vee}(X; \Fp)$ is a priori equipped with an action of the Steenrod algebra \cite{steenrod1962cohomology, may1970general}.
As an application of the explicit construction of a natural $\UM$-coalgebra structure on $\chains(X)$, we can describe at the cochain level this action using the constructions of \cite{medina2020maysteenrod}.
More explicitly, let $\Cp$ be the cyclic group of order $p$ and
\[
\begin{tikzcd} [column sep = .5cm]
\cW(p) = \Fp[\Cp]\{e_0\} & \arrow[l, "\,T"'] \Fp[\Cp]\{e_1\} & \arrow[l, "\,N"'] \Fp[\Cp]\{e_2\} & \arrow[l, "\,T"'] \dotsb
\end{tikzcd}
\]
be the minimal free resolution of $\Fp$ as an $\Fp[\Cp]$-module.
Consider the $\Cp$-equivariant quasi-isomorphism $\psi_\UM \colon \cW(p) \to \UM(p)$ constructed in \cite{medina2020maysteenrod}, and denote by $\psi^{\msimplex{k}}$ its composition with the morphism $\UM \to \End_{\chains(X)}$ defining our $\UM$-coalgebra structure on $\chains(X)$.

If $p$ is the even prime and $s$ is an integer, the \textit{Steenrod operation}
\begin{equation*}
P_s \colon H^\vee_\bullet(A; \bbF_2) \to H^\vee_{\bullet + s}(A; \bbF_2)
\end{equation*}
is defined by sending the class represented by a cocycle $\alpha \in \cochains(X; \bbF_2)$ of degree $q$ to the class represented by the cochain
\[
c \mapsto (\alpha \ot \alpha) \, \psi^{\msimplex{k}}(e_{s-q})(c).
\]

We remark that \textit{Steenrod $(2,i)$-products}, usually referred to as cup-$i$ products, are given by
\begin{equation} \label{e:cup-i products}
(\alpha \smallsmile_i \beta)(c) = (\alpha \ot \beta) \, \psi^{\msimplex{k}}(e_{i})(c).
\end{equation}

If $p$ is an odd prime and $s$ an integer, the \textit{Steenrod operations}
\begin{equation*}
P_s \colon H^\vee_\bullet(X; \Fp_p) \to H^\vee_{\bullet + 2s(p-1)}(X; \Fp_p)
\end{equation*}
and
\begin{equation*}
\beta P_s \colon H^\vee_\bullet(X; \Fp_p) \to H^\vee_{\bullet + 2s(p-1) - 1}(X; \Fp_p)
\end{equation*}
are defined by sending the class represented by a cocycle $\alpha \in \cochains(X; \Fp)$ of degree $q$ to the classes represented respectively for $\varepsilon \in \{0,1\}$ by
\[
c \mapsto
\Big( \alpha^{\ot p} \, (-1)^p \, \nu(q) \, \psi^{\msimplex{k}}(e_{(2s-q)(p-1)-\varepsilon})(c) \Big)
\]
where $\nu(q) = (-1)^{q(q-1)m/2}(m!)^q$ and $m = (p-1)/2$.

Generalizing \eqref{e:cup-i products} we have \textit{Steenrod $(p,i)$-products} defined by
\[
(\alpha_1 \ot \dots \ot \alpha_p) \mapsto \Big( c \mapsto (\alpha_1 \ot \dots \ot \alpha_p) \, \psi^{\msimplex{k}}(e_{i})(c) \Big).
\]

In similar effective manner, for the mod 2 case, explicit Cartan and Adem coboundaries \cite{medina2020cartan, medina2020adem} can be described for the cochain level Steenrod squares of multisimplicial sets.