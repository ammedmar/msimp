% !TEX root = ../msimp.tex

\section{Multisimplicial algebraic topology}\label{s:multisimplicial}

\subsection{Multisimplicial sets}\label{ss:multisimplicial sets}

Let us consider an arbitrary positive integer~$k$.
The \textit{$k$-fold multisimplex category} $\simplex^{\times k}$ is the $k$-fold Cartesian product of the simplex category $\simplex$.
The category
\[
\mSet{k} = \Fun\big((\simplex^{\times k})^\op, \Set\big)
\]
is referred to as the category of \textit{$k$-fold multisimplicial sets}.
We remark that $\mSet{1}$ and $\mSet{2}$ are the categories of simplicial and bisimplicial sets respectively.
A representable $k$-fold multisimplicial sets is denoted by $\simplex^{n_1,\dots,n_k}$.

Explicitly, a $k$-fold multisimplicial set $X$ consists of a collection of sets
\[
X_{m_1,\dots,m_k} = X \big( [m_1] \times\dots\times [m_k] \big)
\]
indexed by $k$-tuples of non-negative integers $(m_1,\dots,m_k)$ together with \textit{face maps}
\[
\face_i^j \colon X_{m_1, \dots, m_j,\dots,m_k} \to X_{m_1, \dots, m_j-1, \dots, m_k}
\]
and \textit{degeneracy map}
\[
\dege^j_i \colon X_{m_1, \dots, m_j,\dots,m_k} \to X_{m_1, \dots, m_j+1, \dots, m_k}
\]
for $1 \leq j \leq k$ and $0 \leq i \leq m_j$ such that, referring to $j$ as the \textit{direction} of these maps, two of them satisfy the simplicial identities when they have the same direction and commute when they do not.
An element of $X_{m_1,\dots,m_k}$ is called an $(m_1,\dots,m_k)$-\textit{multisimplex} and it is said to be \textit{degenerate} if it is in the image of a degeneracy map.

\subsection{Geometric realization}\label{ss:geometric realization}

We will use the following model of the topological simplex:
\[
\gsimplex^n = \big\{
(t_1, \dots, t_n) \in [0,1]^n \mid t_1 \geq \dots \geq t_n
\big\}
\]
with
\[
\delta_i(t_1, \dots, t_n) =
\begin{cases}
	(1, t_1, \dots, t_n) & i = 0, \\
	(t_1, \dots, t_i, t_i, \dots, t_n) & 0 < i < n, \\
	(t_1, \dots, t_n, 0) & i = n,
\end{cases}
\]
and
\[
\sigma_i(t_1, \dots, t_n) = (t_1, \dots, \widehat t_i, \dots, t_n).
\]

The \textit{geometric realization} functor
\[
\bars{-} \colon \mSet{k} \to \Top
\]
is the Yoneda extension of the functor defined on representable objects by
\[
\bars{\simplex^{n_1,\dots,n_k}} = \gmsimplex{n_1}{n_k}.
\]

Explicitly, for a $k$-fold multisimplicial set $X$ we have
\[
\bars{X} \cong
\coprod \gmsimplex{n_1}{n_k} \times X_{n_1,\dots,n_k} \, /_\sim
\]
where
\[
\begin{split}
	(\vec{t}_1, \dots, \vec{t}_j, \dots, \vec{t}_k, \face^j_i(x)) &\sim (\vec{t}_1, \dots, \delta_i(\vec{t}_j), \dots, \vec{t}_k, x), \\
	(\vec{t}_1, \dots, \vec{t}_j, \dots, \vec{t}_k, \dege^j_i(x)) &\sim (\vec{t}_1, \dots, \sigma_i(\vec{t}_j), \dots, \vec{t}_k, x),
\end{split}
\]
which equips $\bars{X}$ with a canonical cellular structure.

The geometric realization functor has a right adjoint
\[
\Sing^{(k)} \colon \Top \to \mSet{k}
\]
defined on a topological space $\fX$, as usual, by the expression
\[
\Sing^{(k)}(\fX)_{n_1,\dots,n_k} =
\Top(\gmsimplex{n_1}{n_k},\fX).
\]

\subsection{Algebraic realization}\label{ss:algebraic realization}

The functor of \textit{chains}
\[
\chains \colon \mSet{k} \to \Ch,
\]
is the Yoneda extension of the functor defined on representable objects by
\[
\chains \big( \simplex^{n_1, \dots, n_k} \big) =
\chains(\simplex^{n_1}) \ot \dotsb \ot \chains(\simplex^{n_k}).
\]
It is naturally isomorphic to the composition of the geometric realization functor and the functor of cellular chains with respect to the canonical cellular structure.

Explicitly, for a $k$-fold multisimplicial set $X$ the $\k$-module $\chains(X)_n$ is freely generated by the non-degenerate $(n_1, \dots, n_k)$-multisimplices with $n_1+\dots+n_k = n$.
The differential $\bd \colon \chains(X)_n \to \chains(X)_{n-1}$ is given on one such basis element by
\[
\bd(x) = \sum_{j=1}^k \sum_{\ell_j=1}^{n_j}
(-1)^{n_{1}+\dots+n_{j-1}+\ell_j} \, \face^j_{\ell_j}(x).
\]

For any topological space $\fX$ the chain complex $\chains\Sing^{(k)}(\fX)$ is denoted $\rS^{(k)}(\fX)$ and referred to as the $k$-\textit{fold singular chains} of $\fX$.

\subsection{Coalgebra structure}\label{ss:coalgebra}

A \textit{counital coalgebra} structure on a chain complex $C$ is a pair of chain maps $\copr \colon C \to C \ot C$ and $\aug \colon C \to \k$ satisfying
\[
(\id \ot \aug) \circ \copr =
\id =
(\aug \ot\, \id) \circ \copr.
\]
The tensor product of two counital coalgebras $C$ and $C'$ is itself a counital coalgebra with structure maps given by
\begin{gather*}
	C \ot C^\prime \xra{\copr \ot \copr^\prime}
	(C \ot C) \ot (C^\prime \ot C^\prime) \xra{\tau}
	(C \ot C^\prime) \ot (C \ot C^\prime), \\
	C \ot C^\prime \xra{\aug \ot \aug^\prime}
	\k \ot \k \xra{\cong} \k,
\end{gather*}
where $\tau$ transposes the second and third factors.

For each $n \in \N$, the complex $\chains(\simplex^n)$ is naturally equipped with a counital coalgebra structure defined by:
\[
\begin{split}
	\copr \big( [v_0, \dots, v_m] \big) &=
	\sum_{i=0}^m \, [v_0, \dots, v_i] \ot [v_i, \dots, v_m], \\
	\aug \big( [v_0, \dots, v_q] \big) &=
	\begin{cases} 1 & \text{ if } q = 0, \\ 0 & \text{ if } q>0. \end{cases}
\end{split}
\]
We will refer to it as the \textit{Alexander--Whitney structure}.

Using the tensor product structure, we deduce a natural counital coalgebra structure on the chains of representable multisimplicial sets
\[
\chains \big( \simplex^{n_1, \dots, n_k} \big) =
\chains(\simplex^{n_1}) \ot \dotsb \ot \chains(\simplex^{n_k})
\]
and, via a Yoneda extension, one on the chains of general multisimplicial sets.

Explicitly, for a $k$-fold multisimplicial set $X$ and $(m_1,\dots,m_k)$-multisimplex $x$ let
\[
\fI_{m_1,\dots,m_k} = \set[\big]{(i_{1},\dots,i_{k}) \mid 0 \le i_j \le m_j,\ \forall j = 1,\dots,k},
\]
then
\[
\copr(x) =
\sum_{I\in \mathfrak{I}_{k,x}} \;
(-1)^{\sum_{1 \leq l<h \leq k} i_h (m_l-i_l) } \
x \rfloor_{(i_{1},\dots,i_{k})} \ot
\!\,_{(m_{1}-i_{1}, \dots, m_{k}-i_{k})} \lfloor x
\]
where the \textit{front $(i_1,\dots,i_k)$-face} of $x$ is the multisimplex
\[
x \rfloor_{(i_{1}, \dots, i_{k})} =
X(F_{i_1}, \dots, F_{i_k})(x) \in X_{i_1,\dots,i_k}
\]
with
$F_{i_j} \colon [i_j] \to [n_j]$ defined by $F_{i_j}(h)=h$, and the \textit{back $(i_1,\dots,i_k)$-face} of $x$ is the multisimplex
\[
\,_{(i_{1}, \dots, i_{k})} \lfloor x =
X(B_{i_1}, \dots, B_{i_k})(x) \in X_{i_1,\dots,i_k}
\]
with $B_{i_j} \colon [i_j] \to [n_j]$ defined by $B_j(h) = h+m_j-i_j$.

\subsection{\pdfEinfty-extension}\label{ss:e-infty extension}

An \textit{$\cM$-bialgebra} is a counital coalgebra $(C, \copr, \aug)$ together with a degree $1$ linear map $\pr \colon C \ot C \to C$ satisfying
\[
\bd (c_1 \ast c_2) - \bd c_1 \ast c_2 + (-1)^{\bars{c_1}} c_1 \ast \bd c_2 =
\aug(c_1) c_2 - \aug(c_2) c_1,
\]
\[
\aug (c_1 \pr c_2) = 0,
\]
for all $c_1, c_2 \in C$.
As proven in \cite{medina2020prop1}, the collection of all maps $\set{C \to C^{\ot r}}_{r \in \N}$ generated by $\copr$, $\aug$ and $\pr$ make $C$ into an $E_\infty$-coalgebra, that is to say, a coalgebra over certain operad $\UM$ that is a cofibrant resolution of the terminal operad.

As proven in \cite{medina2021cobar}, the counital coalgebra structure on the tensor product of two $\cM$-bialgebras $C$ and $C'$ can be naturally extended to an $\cM$-bialgebra structure using
\[
(C \ot C^\prime) \ot (C \ot C^\prime) \xra{\tau}
C \ot C \ot C^\prime \ot C^\prime
\xra{\ \aug \ot \, \id \, \ot \, \pr + \pr \ot \, \id \, \ot \,\aug\ }
C \ot C^\prime.
\]

For any integer $n$, the \textit{join product} $\ast \colon \chains(\simplex^n)^{\ot 2} \to \chains(\simplex^n)$ is the natural degree~$1$ linear map defined by
\begin{equation*}
	\left[v_0, \dots, v_p \right] \pr \left[v_{p+1}, \dots, v_q\right] =
	\begin{cases}
		(-1)^{p} \sign(\pi) \left[v_{\pi(0)}, \dots, v_{\pi(q)}\right] &
		\text{ if } v_i \neq v_j \text{ for } i \neq j, \\
		\hfil 0 & \text{ if not},
	\end{cases}
\end{equation*}
where $\pi$ is the permutation that orders the vertices.
It is proven in \cite{medina2020prop1} that on the chains of representable simplicial sets the Alexander--Whitney structure together with the join product make $\chains(\simplex^n)$ into a natural $\cM$-bialgebra and, consequently, a natural $E_\infty$-coalgebra.
We mention that this structure is induced by one preset at the level of geometric realizations \cite{medina2021prop2}.

Using the tensor product structure, we deduce a natural $\cM$-bialgebra structure on the chains of representable multisimplicial sets
\[
\chains\big(\simplex^{n_1,\dots,n_k}\big) =
\chains(\simplex^{n_1}) \ot\dotsb\ot \chains(\simplex^{n_k}),
\]
and consequently a natural $E_\infty$-coalgebra structure, which extends along the Yoneda inclusion to the chains on any multisimplicial set $X$.

Explicitly, for two basis elements of $\chains\big(\simplex^{n_1,\dots,n_k}\big)$ we have
\[
(x_1 \ot \dotsb \ot x_n) \ast (y_1 \ot \dotsb \ot y_n) =
\sum_{i=1}^n x_{<i}\, \epsilon(y_{<i}) \ot x_i \ast y_i \ot \epsilon(x_{>i}) \, y_{>i},
\]
where, with the convention $x_{<1} = x_{>n} = 1 \in \k$,
\begin{align*}
	z_{<i} & = z_1 \ot \dotsb \ot z_{i-1}, \\
	z_{>i} & = z_{i+1} \ot \dotsb \ot z_n.
\end{align*}

We remark that since the category of $\cM$-bialgebras is not cocomplete, we do not necessarily have an $\cM$-bialgebra structure on $\chains(X)$ for a general multisimplicial set $X$.
An example for which such structure does not exist is given by one such $X$ whose geometric realization consists of just two points.

\subsection{Cubical comparison}\label{ss:cubical}

Since the complex of chains of the $k$-fold multisimplicial set $\msimplex{1}{1}$ is isomorphic to the chains on the standard cubical set $\cube^k$, it is natural to compare the $\cM$-bialgebra structure defined here with that presented in \cite{medina2022cube_einfty}, defining an $E_\infty$-structure on cubical chains.
As counital coalgebras $\chains(\msimplex{1}{1})$ and $\chains(\cube^k)$ are isomorphic, and, denoting the product of the $\cM$-bialgebra defined there by $\widetilde\ast$, we have
\[
x \ \widetilde\ast \ y = (-1)^{\bars{x}} x \ast y
\]
under this chain isomorphism.
The sign convention used here is more natural, used for example to endow Adams' cobar construction with the structure of a monoidal $E_\infty$-coalgebra \cite{medina2021cobar}.

\subsection{Steenrod construction}\label{ss:cup coproducts}

In \cite{steenrod1947products}, Steenrod introduced natural operations on the mod~2 cohomology of spaces, the celebrated \textit{Steenrod squares}
\[
\begin{tikzcd} [column sep=small, row sep=0]
	\Sq^k \colon &[-20] \rH^{-n} \arrow[r] & \rH^{-n-k} \\ &
	{[\alpha]} \arrow[r, mapsto] & \big[ (\alpha \ot \alpha) \Delta_{n-k} \big],
\end{tikzcd}
\]
via an explicit construction of natural linear maps $\Delta_i \colon \chains(X) \to \chains(X) \ot \chains(X)$ for any simplicial set $X$, satisfying up to signs the following homological relations
\[
\bd \circ \, \Delta_i + \Delta_i \circ \bd = (1 + T) \Delta_{i-1},
\]
with the convention $\Delta_{-1} = 0$.
These so-called \textit{cup-$i$ coproducts} appear to be fundamental, as they are axiomatically characterized \cite{medina2022axiomatic} and induce the nerve of strict infinity categories \cite{medina2020globular}.
A description of cup-$i$ coproducts for multisimplicial sets can be deduced from our $E_\infty$-coalgebra structure.
As presented in \cite{medina2023dennis}, it is given recursively by
\[
\begin{split}
	& \Delta_0 = \Delta, \\
	& \Delta_i =
	(\ast \ot \id) \circ (23) \circ (\Delta_{i-1} \ot \id) \circ \Delta.
\end{split}
\]

Steenrod also introduced operations on the mod~$p$ cohomology of spaces when $p$ is an odd prime \cite{steenrod1952reduced, steenrod1953cyclic}.
To define these effectively, generalization of the cup-$i$ coproducts were introduced in \cite{medina2021may_st}.
After the present work, these so-called \textit{cup-$(p,i)$ coproducts} are defined on multisimplicial chains, and their formulas are explicit enough to be implemented in the computer algebra system \href{https://comch.readthedocs.io/en/latest/}{\texttt{ComCH}} \cite{medina2021comch}, where constructions of Cartan and Adem coboundaries \cite{medina2020cartan,medina2021adem,medina2023oddcartan} for multisimplicial sets can also be found.